---
# Example: PagerDuty Publishing Target
apiVersion: v1
kind: Secret
metadata:
  name: publishing-target-pagerduty-prod
  namespace: alert-history
  labels:
    publishing-target: "true"
    target-type: "pagerduty"
    environment: "production"
    managed-by: "alert-history"
type: Opaque
stringData:
  type: "pagerduty"
  url: "https://events.pagerduty.com/v2/enqueue"
  enabled: "true"
  format: "pagerduty"
  routing-key: "R0ABCDEFGHIJKLMNOPQR"  # Replace with actual routing key
  headers: |
    Authorization: Token token=your-api-token-here

---
# Example: Slack Publishing Target
apiVersion: v1
kind: Secret
metadata:
  name: publishing-target-slack-alerts
  namespace: alert-history
  labels:
    publishing-target: "true"
    target-type: "slack"
    environment: "production"
type: Opaque
stringData:
  type: "slack"
  url: "https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXX"
  enabled: "true"
  format: "slack"

---
# Example: Rootly Publishing Target
apiVersion: v1
kind: Secret
metadata:
  name: publishing-target-rootly-incidents
  namespace: alert-history
  labels:
    publishing-target: "true"
    target-type: "rootly"
    environment: "production"
type: Opaque
stringData:
  type: "rootly"
  url: "https://api.rootly.com/v1/incidents"
  enabled: "true"
  format: "rootly"
  headers: |
    Authorization: Bearer your-rootly-api-key-here
    Content-Type: application/json

---
# Example: Generic Webhook Publishing Target
apiVersion: v1
kind: Secret
metadata:
  name: publishing-target-webhook-custom
  namespace: alert-history
  labels:
    publishing-target: "true"
    target-type: "webhook"
    environment: "staging"
type: Opaque
stringData:
  type: "webhook"
  url: "https://example.com/api/webhooks/alerts"
  enabled: "true"
  format: "webhook"
  headers: |
    X-API-Key: your-api-key-here
    X-Custom-Header: custom-value

---
# Example: Alertmanager Publishing Target
apiVersion: v1
kind: Secret
metadata:
  name: publishing-target-alertmanager
  namespace: alert-history
  labels:
    publishing-target: "true"
    target-type: "alertmanager"
    environment: "production"
type: Opaque
stringData:
  type: "alertmanager"
  url: "http://alertmanager.monitoring.svc.cluster.local:9093/api/v1/alerts"
  enabled: "true"
  format: "alertmanager"

---
# Example: Disabled Target (for testing)
apiVersion: v1
kind: Secret
metadata:
  name: publishing-target-test-disabled
  namespace: alert-history
  labels:
    publishing-target: "true"
    target-type: "webhook"
    environment: "test"
type: Opaque
stringData:
  type: "webhook"
  url: "https://httpbin.org/post"
  enabled: "false"  # This target will be discovered but not used
  format: "webhook"

---
# Example: Multi-environment Setup
apiVersion: v1
kind: Secret
metadata:
  name: publishing-target-slack-dev
  namespace: alert-history
  labels:
    publishing-target: "true"
    target-type: "slack"
    environment: "development"
type: Opaque
stringData:
  type: "slack"
  url: "https://hooks.slack.com/services/T00000000/B11111111/YYYYYYYYYYYYYYYYYYYY"
  enabled: "true"
  format: "slack"
  # Filter alerts for dev environment
  filter_config: |
    {
      "severity": ["critical", "warning"],
      "labels": {
        "environment": "development"
      }
    }
