# TN-032: AlertStorage Interface & PostgreSQL - –ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞**: 2025-10-08
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å**: AI Assistant
**–í–µ—Ç–∫–∞**: feature/TN-032-alert-storage
**–ë–∞–∑–æ–≤–∞—è –≤–µ—Ç–∫–∞**: feature/use-LLM

---

## üìä –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –û—Ü–µ–Ω–∫–∞ |
|----------|--------|--------|
| **Requirements ‚Üí Design** | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç | 70% |
| **Design ‚Üí Code** | ‚ö†Ô∏è –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω—ã | 60% |
| **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞** | ‚úÖ –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –µ—Å—Ç—å | 75% |
| **PostgreSQL –∞–¥–∞–ø—Ç–µ—Ä** | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω | 90% |
| **SQLite –∞–¥–∞–ø—Ç–µ—Ä** | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω | 95% |
| **–ú–∏–≥—Ä–∞—Ü–∏–∏** | ‚úÖ –ï—Å—Ç—å (–æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç design) | 85% |
| **–¢–µ—Å—Ç—ã** | ‚ö†Ô∏è –¢–æ–ª—å–∫–æ SQLite | 50% |
| **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** | ‚ö†Ô∏è –£—Å—Ç–∞—Ä–µ–ª–∞ | 40% |

**–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞—á–∏**: **70%** (—á–∞—Å—Ç–∏—á–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, —Ç—Ä–µ–±—É—é—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∏)

---

## 1. –í–∞–ª–∏–¥–∞—Ü–∏—è Requirements ‚Üí Design

### ‚úÖ Requirements (–∏–∑ requirements.md)

```markdown
- AlertStorage –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å CRUD –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- PostgreSQL —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å pgx
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ pagination
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
- Connection pooling
```

### üìù Design (–∏–∑ design.md)

Design –¥–æ–∫—É–º–µ–Ω—Ç –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç:

```go
type AlertStorage interface {
    SaveAlert(ctx context.Context, alert *domain.Alert) error
    GetAlert(ctx context.Context, fingerprint string) (*domain.Alert, error)
    ListAlerts(ctx context.Context, filters AlertFilters) (*AlertList, error)
    UpdateAlert(ctx context.Context, alert *domain.Alert) error
    DeleteAlert(ctx context.Context, fingerprint string) error
    GetStats(ctx context.Context) (*AlertStats, error)
}
```

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è Requirements ‚Üí Design

1. ‚úÖ **CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏**: Design –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ CRUD –º–µ—Ç–æ–¥—ã (Create/Save, Read/Get, Update, Delete)
2. ‚úÖ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: Design –ø—Ä–µ–¥—É—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç `AlertFilters` —Å—Ç—Ä—É–∫—Ç—É—Ä—É
3. ‚úÖ **Pagination**: Design –≤–∫–ª—é—á–∞–µ—Ç `Limit` –∏ `Offset` –≤ `AlertFilters`
4. ‚úÖ **–ò–Ω–¥–µ–∫—Å—ã**: Design –≤–∫–ª—é—á–∞–µ—Ç SQL —Å—Ö–µ–º—É —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
5. ‚ö†Ô∏è **Connection pooling**: Design –ù–ï —É–ø–æ–º–∏–Ω–∞–µ—Ç connection pooling —è–≤–Ω–æ

**–û—Ü–µ–Ω–∫–∞ Requirements ‚Üí Design**: **90%** (pooling –Ω–µ —É–ø–æ–º—è–Ω—É—Ç –≤ design, –Ω–æ —ç—Ç–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è –¥–µ—Ç–∞–ª—å)

---

## 2. –í–∞–ª–∏–¥–∞—Ü–∏—è Design ‚Üí Code

### üîç –†–µ–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

**–§–∞–π–ª**: `go-app/internal/core/interfaces.go` (—Å—Ç—Ä–æ–∫–∏ 97-103)

```go
// AlertStorage interface for alert storage operations
type AlertStorage interface {
    SaveAlert(ctx context.Context, alert *Alert) error
    GetAlertByFingerprint(ctx context.Context, fingerprint string) (*Alert, error)
    GetAlerts(ctx context.Context, filters map[string]any, limit, offset int) ([]*Alert, error)
    CleanupOldAlerts(ctx context.Context, retentionDays int) (int, error)
}
```

### ‚ùå –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è Design ‚Üí Code

| –ú–µ—Ç–æ–¥ –∏–∑ Design | –°—Ç–∞—Ç—É—Å –≤ Code | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------------|---------------|-------------|
| `SaveAlert` | ‚úÖ –ï—Å—Ç—å | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏–¥–µ–Ω—Ç–∏—á–Ω–æ |
| `GetAlert` | ‚ö†Ô∏è –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω | –í –∫–æ–¥–µ: `GetAlertByFingerprint` (–±–æ–ª–µ–µ —è–≤–Ω–æ–µ –∏–º—è) |
| `ListAlerts` | ‚ö†Ô∏è –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω | –í –∫–æ–¥–µ: `GetAlerts` (—É–ø—Ä–æ—â—ë–Ω–Ω–æ–µ –∏–º—è) |
| `UpdateAlert` | ‚ùå –ù–µ—Ç | **–û–¢–°–£–¢–°–¢–í–£–ï–¢** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è upsert –≤ SaveAlert |
| `DeleteAlert` | ‚ùå –ù–µ—Ç | **–û–¢–°–£–¢–°–¢–í–£–ï–¢** - –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| `GetStats` | ‚ùå –ù–µ—Ç –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –∞–¥–∞–ø—Ç–µ—Ä–µ (Database.GetStats) |
| `CleanupOldAlerts` | ‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π | **–î–û–ë–ê–í–õ–ï–ù** - –Ω–µ –±—ã–ª –≤ design.md |

### ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö

**Design –ø—Ä–µ–¥–ª–∞–≥–∞–ª**:
```go
type AlertFilters struct {
    Status      *domain.AlertStatus `json:"status,omitempty"`
    Severity    *domain.Severity    `json:"severity,omitempty"`
    Namespace   *string             `json:"namespace,omitempty"`
    Labels      map[string]string   `json:"labels,omitempty"`
    TimeRange   *TimeRange          `json:"time_range,omitempty"`
    Limit       int                 `json:"limit"`
    Offset      int                 `json:"offset"`
}

type AlertList struct {
    Alerts []domain.Alert `json:"alerts"`
    Total  int            `json:"total"`
    Limit  int            `json:"limit"`
    Offset int            `json:"offset"`
}
```

**–ö–æ–¥ —Ä–µ–∞–ª–∏–∑—É–µ—Ç**:
```go
GetAlerts(ctx context.Context, filters map[string]any, limit, offset int) ([]*Alert, error)
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –í–º–µ—Å—Ç–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `map[string]any`, —á—Ç–æ:
- ‚ùå –¢–µ—Ä—è–µ—Ç—Å—è type safety
- ‚ùå –ù–µ—Ç compile-time –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª–µ–π
- ‚ùå –£—Å–ª–æ–∂–Ω—è–µ—Ç—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ runtime –æ—à–∏–±–∫–∞–º

**–û—Ü–µ–Ω–∫–∞ Design ‚Üí Code**: **60%** (–±–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –µ—Å—Ç—å, –Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç 3 –º–µ—Ç–æ–¥–∞ –∏–∑ 6)

---

## 3. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ PostgreSQL –∞–¥–∞–ø—Ç–µ—Ä–∞

**–§–∞–π–ª**: `go-app/internal/infrastructure/postgres_adapter.go`

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã AlertStorage

| –ú–µ—Ç–æ–¥ | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | –ö–∞—á–µ—Å—Ç–≤–æ | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|-------|------------|----------|------------|
| `SaveAlert` | ‚úÖ –°—Ç—Ä–æ–∫–∏ 236-261 | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç UPSERT (ON CONFLICT), JSONB |
| `GetAlertByFingerprint` | ‚úÖ –°—Ç—Ä–æ–∫–∏ 263-286 | ‚≠ê‚≠ê‚≠ê‚≠ê | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ "not found" |
| `GetAlerts` | ‚úÖ –°—Ç—Ä–æ–∫–∏ 288-355 | ‚≠ê‚≠ê‚≠ê‚≠ê | –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä—ã, pagination |
| `CleanupOldAlerts` | ‚úÖ –°—Ç—Ä–æ–∫–∏ 357-375 | ‚≠ê‚≠ê‚≠ê‚≠ê | –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ retention period |

### ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã Database

| –ú–µ—Ç–æ–¥ | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|-------|------------|------------|
| `SaveClassification` | ‚úÖ –°—Ç—Ä–æ–∫–∏ 377-404 | –î–ª—è LLM –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ |
| `GetClassification` | ‚úÖ –°—Ç—Ä–æ–∫–∏ 406-429 | –î–ª—è LLM –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ |
| `LogPublishingAttempt` | ‚úÖ –°—Ç—Ä–æ–∫–∏ 431-449 | –î–ª—è publishing –ª–æ–≥–æ–≤ |
| `GetPublishingHistory` | ‚úÖ –°—Ç—Ä–æ–∫–∏ 451-484 | –î–ª—è publishing –∏—Å—Ç–æ—Ä–∏–∏ |
| `GetStats` | ‚úÖ –°—Ç—Ä–æ–∫–∏ 493-533 | –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ + pool stats |
| `MigrateUp` | ‚úÖ –°—Ç—Ä–æ–∫–∏ 161-234 | In-code –º–∏–≥—Ä–∞—Ü–∏–∏ (—É–ø—Ä–æ—â—ë–Ω–Ω—ã–µ) |

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã PostgreSQL –∞–¥–∞–ø—Ç–µ—Ä–∞

1. **‚ùå –ù–µ—Ç PostgreSQL —Ç–µ—Å—Ç–æ–≤**
   - –ï—Å—Ç—å —Ç–æ–ª—å–∫–æ `sqlite_adapter_test.go`
   - PostgreSQL –∞–¥–∞–ø—Ç–µ—Ä –Ω–µ –ø–æ–∫—Ä—ã—Ç unit —Ç–µ—Å—Ç–∞–º–∏
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: —Å–æ–∑–¥–∞—Ç—å `postgres_adapter_test.go` —Å testcontainers

2. **‚ö†Ô∏è In-code –º–∏–≥—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç —Å goose –º–∏–≥—Ä–∞—Ü–∏—è–º–∏**
   - `MigrateUp()` —Å–æ–∑–¥–∞—ë—Ç —É–ø—Ä–æ—â—ë–Ω–Ω—É—é —Å—Ö–µ–º—É (—Å—Ç—Ä–æ–∫–∏ 168-234)
   - –†–µ–∞–ª—å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –≤ `migrations/20250911094416_initial_schema.sql` –Ω–∞–º–Ω–æ–≥–æ —Å–ª–æ–∂–Ω–µ–µ
   - **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ö–µ–º**:
     - In-code: `alerts.alert_data JSONB`
     - Migration: `alerts` —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏ (`alert_name`, `status`, `labels`, `annotations`)
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: —É–¥–∞–ª–∏—Ç—å in-code –º–∏–≥—Ä–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ goose

3. **‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è JSONB –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ü–µ–ª–æ–≥–æ –∞–ª–µ—Ä—Ç–∞**
   - In-code –º–∏–≥—Ä–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏—Ç –≤–µ—Å—å Alert –∫–∞–∫ JSONB blob
   - –†–µ–∞–ª—å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
   - –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏—è–º–∏

**–û—Ü–µ–Ω–∫–∞ PostgreSQL –∞–¥–∞–ø—Ç–µ—Ä–∞**: **90%** (–æ—Ç–ª–∏—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è, –Ω–æ –Ω—É–∂–Ω—ã —Ç–µ—Å—Ç—ã –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏–π)

---

## 4. –ê–Ω–∞–ª–∏–∑ –º–∏–≥—Ä–∞—Ü–∏–π

### ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è 20250911094416_initial_schema.sql

**–§–∞–π–ª**: `go-app/migrations/20250911094416_initial_schema.sql`

**–ö–∞—á–µ—Å—Ç–≤–æ**: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (Excellent)

–ú–∏–≥—Ä–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç:

1. ‚úÖ **–¢–∞–±–ª–∏—Ü–∞ `alerts`** (—Å—Ç—Ä–æ–∫–∏ 11-25)
   - –ü–æ–ª–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
   - –û—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è `alert_name`, `status`, `labels`, `annotations`
   - JSONB –¥–ª—è `labels` –∏ `annotations`
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã: `TIMESTAMP WITH TIME ZONE`, `VARCHAR`

2. ‚úÖ **–ò–Ω–¥–µ–∫—Å—ã** (—Å—Ç—Ä–æ–∫–∏ 117-125)
   ```sql
   CREATE UNIQUE INDEX idx_alerts_fingerprint_unique ON alerts(fingerprint);
   CREATE INDEX idx_alerts_alert_name ON alerts(alert_name);
   CREATE INDEX idx_alerts_namespace ON alerts(namespace);
   CREATE INDEX idx_alerts_status ON alerts(status);
   CREATE INDEX idx_alerts_timestamp ON alerts(timestamp DESC);
   CREATE INDEX idx_alerts_labels_gin ON alerts USING GIN(labels);
   CREATE INDEX idx_alerts_annotations_gin ON alerts USING GIN(annotations);
   CREATE INDEX idx_alerts_name_status_time ON alerts(alert_name, status, timestamp DESC);
   ```
   - ‚úÖ Composite index –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - ‚úÖ GIN –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è JSONB
   - ‚úÖ DESC –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

3. ‚úÖ **Triggers –¥–ª—è updated_at** (—Å—Ç—Ä–æ–∫–∏ 145-167)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `updated_at`

4. ‚úÖ **Views** (—Å—Ç—Ä–æ–∫–∏ 170-199)
   - `alerts_with_classification` - JOIN —Å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è–º–∏
   - `publishing_stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–π

5. ‚úÖ **Cleanup —Ñ—É–Ω–∫—Ü–∏—è** (—Å—Ç—Ä–æ–∫–∏ 202-219)
   - `cleanup_old_data(retention_days)` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏

6. ‚úÖ **Default filter rules** (—Å—Ç—Ä–æ–∫–∏ 222-226)
   - –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –∫–æ–¥–∞

**–í –º–∏–≥—Ä–∞—Ü–∏–∏**:
```sql
CREATE TABLE alerts (
    fingerprint VARCHAR(64),
    alert_name VARCHAR(255),
    status VARCHAR(20),
    labels JSONB,
    annotations JSONB,
    starts_at TIMESTAMP,
    ...
)
```

**–í postgres_adapter.go SaveAlert()**:
```go
query := `
    INSERT INTO alerts (fingerprint, alert_data)
    VALUES ($1, $2)
    ON CONFLICT (fingerprint)
    DO UPDATE SET alert_data = EXCLUDED.alert_data, updated_at = NOW()
`
```

**‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê**: –ö–æ–¥ –ø—ã—Ç–∞–µ—Ç—Å—è –≤—Å—Ç–∞–≤–∏—Ç—å –≤ –∫–æ–ª–æ–Ω–∫—É `alert_data`, –∫–æ—Ç–æ—Ä–æ–π –ù–ï–¢ –≤ –º–∏–≥—Ä–∞—Ü–∏–∏!

**–û—Ü–µ–Ω–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π**: **85%** (–æ—Ç–ª–∏—á–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è, –Ω–æ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å –∫–æ–¥–æ–º –∞–¥–∞–ø—Ç–µ—Ä–∞)

---

## 5. –ê–Ω–∞–ª–∏–∑ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è

### ‚úÖ SQLite —Ç–µ—Å—Ç—ã

**–§–∞–π–ª**: `go-app/internal/infrastructure/sqlite_adapter_test.go`

**–ü–æ–∫—Ä—ã—Ç–∏–µ**: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (Excellent)

–¢–µ—Å—Ç—ã –≤–∫–ª—é—á–∞—é—Ç:
- ‚úÖ `TestSQLiteDatabase_Connect` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- ‚úÖ `TestSQLiteDatabase_InMemory` - in-memory –±–∞–∑–∞
- ‚úÖ `TestSQLiteDatabase_Migrate` - –º–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ `TestSQLiteDatabase_CRUD` - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ `TestSQLiteDatabase_Transaction` - —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- ‚úÖ `TestSQLiteDatabase_Health` - health check
- ‚úÖ `TestSQLiteDatabase_Query` - –∑–∞–ø—Ä–æ—Å—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—É—Å–∫–∞**:
```
PASS: TestSQLiteDatabase_Connect (0.00s)
PASS: TestSQLiteDatabase_InMemory (0.00s)
PASS: TestSQLiteDatabase_Migrate (0.01s)
PASS: TestSQLiteDatabase_CRUD (0.01s)
PASS: TestSQLiteDatabase_Transaction (0.00s)
PASS: TestSQLiteDatabase_Health (0.00s)
PASS: TestSQLiteDatabase_Query (0.00s)
```

### ‚ùå PostgreSQL —Ç–µ—Å—Ç—ã

**–°—Ç–∞—Ç—É—Å**: **–ù–ï –ù–ê–ô–î–ï–ù–´**

**–ü—Ä–æ–±–ª–µ–º–∞**: PostgreSQL –∞–¥–∞–ø—Ç–µ—Ä –Ω–µ –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ —ç—Ç–æ production –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**:
1. –°–æ–∑–¥–∞—Ç—å `postgres_adapter_test.go`
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `testcontainers-go` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ PostgreSQL –≤ Docker
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –º–µ—Ç–æ–¥—ã AlertStorage
4. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ edge cases (NULL –∑–Ω–∞—á–µ–Ω–∏—è, invalid fingerprints, concurrent access)

**–û—Ü–µ–Ω–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è**: **50%** (SQLite –æ—Ç–ª–∏—á–Ω–æ, PostgreSQL –Ω–µ –ø–æ–∫—Ä—ã—Ç)

---

## 6. –ë–ª–æ–∫–µ—Ä—ã –∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å –¥—Ä—É–≥–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

| –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å | –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç TN-032 |
|--------|--------|----------------------|
| TN-031 | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Alert domain models |
| TN-033 | ‚è∏Ô∏è –ù–µ –Ω–∞—á–∞—Ç–∞ | –¢—Ä–µ–±—É–µ—Ç AlertStorage –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ |
| TN-034 | ‚è∏Ô∏è –ù–µ –Ω–∞—á–∞—Ç–∞ | –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç |
| TN-037 | ‚è∏Ô∏è –ù–µ –Ω–∞—á–∞—Ç–∞ | **–ë–õ–û–ö–ò–†–£–ï–¢–°–Ø** - —Ç—Ä–µ–±—É–µ—Ç AlertStorage —Å pagination |

### ‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã

1. **TN-037 (Alert history repository —Å pagination)**
   - –¢—Ä–µ–±—É–µ—Ç —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ `AlertFilters` –∏ `AlertList`
   - –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `map[string]any` - –Ω–µ—É–¥–æ–±–Ω–æ –¥–ª—è API
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–µ—Ä–µ–¥ TN-037

2. **TN-033 (Alert classification service)**
   - –¢—Ä–µ–±—É–µ—Ç `ClassificationStorage.SaveClassification`
   - ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö
   - –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

3. **TN-038 (Alert analytics service)**
   - –¢—Ä–µ–±—É–µ—Ç `GetStats()` –º–µ—Ç–æ–¥
   - ‚ö†Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ç–æ–ª—å–∫–æ –≤ `Database` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ, –Ω–µ –≤ `AlertStorage`
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π `AnalyticsStorage`

---

## 7. –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∑–∞–¥–∞—á–∏

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏–µ

**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏**:
1. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ AlertStorage –≤ –∫–æ–¥–µ? ‚úÖ –î–ê
2. –ï—Å—Ç—å –ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏? ‚ùå –ù–ï–¢
3. –ò–∑–º–µ–Ω–∏–ª–∏—Å—å –ª–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Å –º–æ–º–µ–Ω—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è? ‚ö†Ô∏è –í–û–ó–ú–û–ñ–ù–û

**–ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ**:

1. **TN-031 –∑–∞–≤–µ—Ä—à–µ–Ω–∞** (2025-10-08)
   - Alert domain models –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
   - AlertStorage –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–∏ –º–æ–¥–µ–ª–∏
   - ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞

2. **–ü–æ—è–≤–∏–ª–∏—Å—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è**
   - `ClassificationStorage` - –¥–ª—è LLM –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - `PublishingLogStorage` - –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–π
   - ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö

3. **–ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å**
   - –î–æ–±–∞–≤–ª–µ–Ω goose –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π
   - In-code –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ –∞–¥–∞–ø—Ç–µ—Ä–∞—Ö —É—Å—Ç–∞—Ä–µ–ª–∏
   - ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

**–û—Ü–µ–Ω–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏**: **85%** (–∑–∞–¥–∞—á–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –Ω–æ–≤—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏)

---

## 8. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é –∑–∞–¥–∞—á–∏

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (MUST DO)

1. **–£—Å—Ç—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç –º–∏–≥—Ä–∞—Ü–∏–π** (Priority: CRITICAL)
   - –£–¥–∞–ª–∏—Ç—å in-code –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–∑ `postgres_adapter.go`
   - –û–±–Ω–æ–≤–∏—Ç—å `SaveAlert` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Å—Ö–µ–º–æ–π
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–µ–π `20250911094416_initial_schema.sql`

2. **–°–æ–∑–¥–∞—Ç—å PostgreSQL —Ç–µ—Å—Ç—ã** (Priority: CRITICAL)
   - –§–∞–π–ª: `postgres_adapter_test.go`
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `testcontainers-go`
   - –ü–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ AlertStorage

3. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å Design –∏ Code** (Priority: HIGH)
   - –†–µ—à–∏—Ç—å: –æ—Å—Ç–∞–≤–∏—Ç—å `map[string]any` –∏–ª–∏ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ `AlertFilters`
   - –ï—Å–ª–∏ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å - –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –≤—Å–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
   - –û–±–Ω–æ–≤–∏—Ç—å `design.md` —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º

### üü° –í–∞–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏ (SHOULD DO)

4. **–î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –º–µ—Ç–æ–¥—ã** (Priority: MEDIUM)
   - `UpdateAlert` - –¥–ª—è —è–≤–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —á—Ç–æ SaveAlert - upsert)
   - `DeleteAlert` - –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∞–ª–µ—Ä—Ç–∞ –ø–æ fingerprint
   - `GetStats` - –¥–æ–±–∞–≤–∏—Ç—å –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å AlertStorage –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π

5. **–£–ª—É—á—à–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** (Priority: MEDIUM)
   - –û–±–Ω–æ–≤–∏—Ç—å `requirements.md` —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏
   - –û–±–Ω–æ–≤–∏—Ç—å `design.md` —Å —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π
   - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ `README.md`

6. **–î–æ–±–∞–≤–∏—Ç—å validation** (Priority: MEDIUM)
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (fingerprint –Ω–µ –ø—É—Å—Ç–æ–π, limit > 0)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `validator/v10` –∏–∑ Alert –º–æ–¥–µ–ª–∏

### üü¢ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ (NICE TO HAVE)

7. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** (Priority: LOW)
   - Benchmark —Ç–µ—Å—Ç—ã –¥–ª—è AlertStorage –º–µ—Ç–æ–¥–æ–≤
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (EXPLAIN ANALYZE)
   - –î–æ–±–∞–≤–∏—Ç—å prepared statements

8. **Observability** (Priority: LOW)
   - –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç–æ–¥–∞ (duration, errors)
   - Structured logging –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
   - Tracing –¥–ª—è debug

---

## 9. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ tasks.md

### ‚ùå –°—Ç–∞—Ä—ã–µ —á–µ–∫–±–æ–∫—Å—ã (–∏–∑ tasks.md)

```markdown
- [ ] 1. –°–æ–∑–¥–∞—Ç—å internal/core/interfaces/storage.go
- [ ] 2. –°–æ–∑–¥–∞—Ç—å internal/infrastructure/storage/postgresql.go
- [ ] 3. –î–æ–±–∞–≤–∏—Ç—å SQL —Å—Ö–µ–º—É –≤ migrations/
- [ ] 4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ –º–µ—Ç–æ–¥—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- [ ] 5. –î–æ–±–∞–≤–∏—Ç—å connection pooling
- [ ] 6. –°–æ–∑–¥–∞—Ç—å storage_test.go
- [ ] 7. –ö–æ–º–º–∏—Ç: `feat(go): TN-032 implement AlertStorage`
```

### ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —á–µ–∫–±–æ–∫—Å—ã (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ)

```markdown
- [x] 1. –°–æ–∑–¥–∞—Ç—å AlertStorage –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ‚úÖ (internal/core/interfaces.go)
- [x] 2. –°–æ–∑–¥–∞—Ç—å PostgreSQL –∞–¥–∞–ø—Ç–µ—Ä ‚úÖ (internal/infrastructure/postgres_adapter.go)
- [x] 3. –°–æ–∑–¥–∞—Ç—å SQLite –∞–¥–∞–ø—Ç–µ—Ä ‚úÖ (internal/infrastructure/sqlite_adapter.go)
- [x] 4. –î–æ–±–∞–≤–∏—Ç—å SQL —Å—Ö–µ–º—É –≤ migrations/ ‚úÖ (20250911094416_initial_schema.sql)
- [x] 5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã (Save, Get, List, Cleanup) ‚úÖ
- [x] 6. –î–æ–±–∞–≤–∏—Ç—å connection pooling ‚úÖ (pgxpool)
- [x] 7. –°–æ–∑–¥–∞—Ç—å SQLite —Ç–µ—Å—Ç—ã ‚úÖ (sqlite_adapter_test.go)
- [ ] 8. ‚ùå –°–æ–∑–¥–∞—Ç—å PostgreSQL —Ç–µ—Å—Ç—ã (postgres_adapter_test.go) - –û–¢–°–£–¢–°–¢–í–£–ï–¢
- [ ] 9. ‚ö†Ô∏è –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç in-code –º–∏–≥—Ä–∞—Ü–∏–π –∏ goose - –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê
- [ ] 10. ‚ö†Ô∏è –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å SaveAlert —Å —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
- [ ] 11. ‚ö†Ô∏è –†–µ—à–∏—Ç—å –≤–æ–ø—Ä–æ—Å —Å —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π —Ñ–∏–ª—å—Ç—Ä–æ–≤ (map vs AlertFilters)
- [ ] 12. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –º–µ—Ç–æ–¥—ã (UpdateAlert, DeleteAlert, GetStats –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- [ ] 13. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (requirements.md, design.md, tasks.md)
```

---

## 10. –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∑–∞–¥–∞—á–∏ TN-032

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –í—ã–ø–æ–ª–Ω–µ–Ω–æ | –í—Å–µ–≥–æ | % |
|-----------|-----------|-------|---|
| **Requirements** | 4 / 5 | 5 | 80% |
| **Design —ç–ª–µ–º–µ–Ω—Ç—ã** | 3 / 6 –º–µ—Ç–æ–¥–æ–≤ | 6 | 50% |
| **PostgreSQL –∞–¥–∞–ø—Ç–µ—Ä** | 4 / 4 –±–∞–∑–æ–≤—ã—Ö | 4+ | 100% –±–∞–∑–æ–≤—ã—Ö |
| **–ú–∏–≥—Ä–∞—Ü–∏–∏** | 1 / 1 | 1 | 100% |
| **–¢–µ—Å—Ç—ã** | 1 / 2 –∞–¥–∞–ø—Ç–µ—Ä–∞ | 2 | 50% |
| **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** | 3 / 3 —Ñ–∞–π–ª–∞ | 3 | 100% (–Ω–æ —É—Å—Ç–∞—Ä–µ–ª–∞) |

**–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å**: **70%** –∑–∞–≤–µ—Ä—à–µ–Ω–æ

### üéØ Definition of Done

–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ tasks.md:

1. ‚úÖ `requirements.md`: —Ü–µ–ª—å, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏ - **–ï–°–¢–¨**
2. ‚úÖ `design.md`: –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è - **–ï–°–¢–¨** (–Ω–æ —É—Å—Ç–∞—Ä–µ–ª–∞)
3. ‚úÖ `tasks.md`: —á–µ–∫-–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ - **–ï–°–¢–¨** (–Ω–æ —É—Å—Ç–∞—Ä–µ–ª)
4. ‚ö†Ô∏è –ö–æ–¥ + —Ç–µ—Å—Ç—ã –≤ –≤–µ—Ç–∫–µ `feature/TN-XX-*` - **–ß–ê–°–¢–ò–ß–ù–û** (–Ω–µ—Ç PostgreSQL —Ç–µ—Å—Ç–æ–≤)
5. ‚ùå CI –∑–µ–ª—ë–Ω—ã–π, –ª–∏–Ω—Ç–µ—Ä—ã –∏ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç - **–ù–ï –ü–†–û–í–ï–†–ï–ù–û**
6. ‚ùå Pull Request —Å review - **–ù–ï–¢**
7. ‚ùå Merged –≤ main - **–ù–ï–¢**

**Definition of Done**: **2/7** (29%) - –∑–∞–¥–∞—á–∞ –ù–ï –≥–æ—Ç–æ–≤–∞ –∫ –∑–∞–∫—Ä—ã—Ç–∏—é

### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Ö–æ—Ä–æ—à–æ

1. ‚ú® **–û—Ç–ª–∏—á–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è** - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ PostgreSQL —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏, views, triggers
2. ‚ú® **–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ SQLite —Ç–µ—Å—Ç—ã** - comprehensive coverage
3. ‚ú® **Connection pooling** - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ pgxpool
4. ‚ú® **Dual –∞–¥–∞–ø—Ç–µ—Ä—ã** - PostgreSQL –¥–ª—è prod, SQLite –¥–ª—è dev/testing
5. ‚ú® **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥** - —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ Go idioms –∏ SOLID

### ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

1. üî¥ **–ö–æ–Ω—Ñ–ª–∏–∫—Ç –º–∏–≥—Ä–∞—Ü–∏–π** - in-code –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å goose –º–∏–≥—Ä–∞—Ü–∏–µ–π
2. üî¥ **SaveAlert –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** - –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å–∞—Ç—å –≤ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–æ–ª–æ–Ω–∫—É `alert_data`
3. üî¥ **–ù–µ—Ç PostgreSQL —Ç–µ—Å—Ç–æ–≤** - production –∞–¥–∞–ø—Ç–µ—Ä –Ω–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
4. üü° **–£—Å—Ç–∞—Ä–µ–≤—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - design.md –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–¥—É
5. üü° **–ù–µ–ø–æ–ª–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç Update, Delete, GetStats

### üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

**–î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ TN-032 –Ω–∞ 100% –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ**:

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ** (1-2 —á–∞—Å–∞):
   - –ò—Å–ø—Ä–∞–≤–∏—Ç—å `SaveAlert` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Å—Ö–µ–º–æ–π
   - –£–¥–∞–ª–∏—Ç—å in-code –º–∏–≥—Ä–∞—Ü–∏–∏ (–∏–ª–∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ)
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î

2. **–í –±–ª–∏–∂–∞–π—à–∏–µ –¥–Ω–∏** (4-6 —á–∞—Å–æ–≤):
   - –°–æ–∑–¥–∞—Ç—å `postgres_adapter_test.go` —Å testcontainers
   - –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –º–µ—Ç–æ–¥—ã –∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—á–µ–º—É –∏—Ö –Ω–µ—Ç
   - –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

3. **–ü–µ—Ä–µ–¥ merge** (2-3 —á–∞—Å–∞):
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CI
   - Code review
   - –û–±–Ω–æ–≤–∏—Ç—å –≥–ª–∞–≤–Ω—ã–π tasks.md

---

## 11. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ó–∞–¥–∞—á–∞ **TN-032 AlertStorage Interface & PostgreSQL Implementation** –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –Ω–∞ **70%**.

**–ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç**, –Ω–æ –µ—Å—Ç—å **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã**:
- ‚ùå SaveAlert –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º —Å –º–∏–≥—Ä–∞—Ü–∏–µ–π
- ‚ùå PostgreSQL –Ω–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- ‚ö†Ô∏è –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —É—Å—Ç–∞—Ä–µ–ª–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: **–ù–ï –∑–∞–∫—Ä—ã–≤–∞—Ç—å –∑–∞–¥–∞—á—É** –¥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º.

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: **HIGH** - –±–ª–æ–∫–∏—Ä—É–µ—Ç TN-037 (pagination API)

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ**: **8-12 —á–∞—Å–æ–≤** —Ä–∞–±–æ—Ç—ã

---

**–î–∞—Ç–∞ –æ—Ç—á—ë—Ç–∞**: 2025-10-08
**–°–ª–µ–¥—É—é—â–∏–π review**: –ø–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É**: [–Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω]
