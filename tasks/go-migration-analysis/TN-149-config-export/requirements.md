# TN-149: GET /api/v2/config - Export Current Configuration

**Date**: 2025-11-21
**Task ID**: TN-149
**Phase**: Phase 10 - Config Management
**Quality Target**: 150% (Grade A+ EXCEPTIONAL)
**Status**: üìã Analysis & Planning Phase

---

## üéØ Executive Summary

**TN-149** —Ä–µ–∞–ª–∏–∑—É–µ—Ç endpoint **GET /api/v2/config** –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–∞—Ö JSON –∏ YAML. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π, –æ—Ç–ª–∞–¥–∫–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

### –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å

1. **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**: –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º –≤–∏–¥–µ—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º
2. **–û—Ç–ª–∞–¥–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: –£–ø—Ä–æ—â–∞–µ—Ç troubleshooting –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º**: –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤–Ω–µ—à–Ω–∏–º —Å–∏—Å—Ç–µ–º–∞–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
5. **Alertmanager Compatibility**: –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Alertmanager API v2 –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏

---

## üìã Requirements Analysis

### 1. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (FR)

#### FR-1: –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P0 (Critical)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: Endpoint –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø–æ–ª–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
- **Acceptance Criteria**:
  - ‚úÖ GET /api/v2/config –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200 OK —Å JSON body
  - ‚úÖ Content-Type: application/json
  - ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç Config struct –∏–∑ `internal/config/config.go`
  - ‚úÖ –í—Å–µ —Å–µ–∫—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç (Server, Database, Redis, LLM, Log, Cache, Lock, App, Metrics, Webhook)
  - ‚úÖ –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è

#### FR-2: –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ YAML —Ñ–æ—Ä–º–∞—Ç–µ
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P0 (Critical)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ YAML —Ñ–æ—Ä–º–∞—Ç–∞ —á–µ—Ä–µ–∑ query parameter `?format=yaml`
- **Acceptance Criteria**:
  - ‚úÖ GET /api/v2/config?format=yaml –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç YAML
  - ‚úÖ Content-Type: text/yaml –∏–ª–∏ application/x-yaml
  - ‚úÖ YAML –≤–∞–ª–∏–¥–Ω—ã–π –∏ –ø–∞—Ä—Å–∏—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –ø–∞—Ä—Å–µ—Ä–∞–º–∏
  - ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–∞ JSON –≤–µ—Ä—Å–∏–∏

#### FR-3: –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P0 (Critical)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ –ø–∞—Ä–æ–ª–µ–π, API –∫–ª—é—á–µ–π, —Ç–æ–∫–µ–Ω–æ–≤
- **Acceptance Criteria**:
  - ‚úÖ –ü–∞—Ä–æ–ª–∏ –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ `***REDACTED***` –∏–ª–∏ `[REDACTED]`
  - ‚úÖ API –∫–ª—é—á–∏ (LLM, webhook) —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è
  - ‚úÖ JWT secrets —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è
  - ‚úÖ Database passwords —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è
  - ‚úÖ Redis passwords —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è
  - ‚úÖ Query parameter `?sanitize=false` –æ—Ç–∫–ª—é—á–∞–µ—Ç —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—é (—Ç–æ–ª—å–∫–æ –¥–ª—è admin)
  - ‚úÖ –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞

#### FR-4: –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P1 (High)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- **Acceptance Criteria**:
  - ‚úÖ Response –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–µ `version` (—Ö–µ—à –∏–ª–∏ timestamp)
  - ‚úÖ Response –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–µ `source` (file, env, defaults)
  - ‚úÖ Response –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–µ `loaded_at` (timestamp –∑–∞–≥—Ä—É–∑–∫–∏)
  - ‚úÖ Response –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–µ `config_file_path` (–µ—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ —Ñ–∞–π–ª–∞)

#### FR-5: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–µ–∫—Ü–∏–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P1 (High)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ query parameters
- **Acceptance Criteria**:
  - ‚úÖ `?sections=server,database` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Å–µ–∫—Ü–∏–∏
  - ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ —Å–µ–∫—Ü–∏–∏: server, database, redis, llm, log, cache, lock, app, metrics, webhook
  - ‚úÖ –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—Ü–∏–π —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
  - ‚úÖ –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è —Å warning –≤ –ª–æ–≥–∞—Ö

#### FR-6: Diff –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P2 (Medium)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å —ç—Ç–∞–ª–æ–Ω–Ω–æ–π —á–µ—Ä–µ–∑ query parameter
- **Acceptance Criteria**:
  - ‚úÖ `?diff=base64_encoded_config` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç diff –º–µ–∂–¥—É —Ç–µ–∫—É—â–µ–π –∏ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
  - ‚úÖ Diff –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON patch –∏–ª–∏ unified diff
  - ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—è

### 2. –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (NFR)

#### NFR-1: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–¶–µ–ª–µ–≤–æ–π p95 latency**: < 5ms
- **–¶–µ–ª–µ–≤–æ–π p99 latency**: < 10ms
- **Throughput**: > 1,000 req/s
- **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**: Endpoint –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –æ—Ç–ª–∞–¥–∫–∏, –Ω–µ –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É

#### NFR-2: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ API)
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: Admin-only –¥–ª—è unsanitized config
- **Rate Limiting**: 100 req/min per IP (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ª–∏–º–∏—Ç)
- **–°–µ–∫—Ä–µ—Ç—ã**: –í—Å–µ–≥–¥–∞ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- **CORS**: –°–ª–µ–¥—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º CORS

#### NFR-3: –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- **Availability**: 99.9% (–≤–º–µ—Å—Ç–µ —Å –æ—Å–Ω–æ–≤–Ω—ã–º API)
- **Error Handling**: Graceful degradation –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- **Fallback**: –í–æ–∑–≤—Ä–∞—Ç —á–∞—Å—Ç–∏—á–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–µ–∫—Ü–∏–π
- **Timeout**: 5s –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞

#### NFR-4: –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- **Alertmanager API v2**: 100% —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç–∞ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)
- **OpenAPI 3.0**: –ü–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
- **Backward Compatibility**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ /api/v1/config (deprecated)

#### NFR-5: Observability
- **Prometheus Metrics**:
  - `config_export_requests_total` (counter, by format, sanitized)
  - `config_export_duration_seconds` (histogram)
  - `config_export_errors_total` (counter, by error_type)
  - `config_export_size_bytes` (histogram)
- **Structured Logging**: –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å request_id
- **Tracing**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å distributed tracing (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)

#### NFR-6: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **OpenAPI Spec**: –ü–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è endpoint
- **API Guide**: –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **Security Guide**: –û–ø–∏—Å–∞–Ω–∏–µ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤
- **Troubleshooting**: –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

---

## üîç Technical Analysis

### 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑

#### 3.1 –¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```go
// internal/config/config.go
type Config struct {
    Server   ServerConfig   `mapstructure:"server"`
    Database DatabaseConfig `mapstructure:"database"`
    Redis    RedisConfig    `mapstructure:"redis"`
    LLM      LLMConfig      `mapstructure:"llm"`
    Log      LogConfig      `mapstructure:"log"`
    Cache    CacheConfig    `mapstructure:"cache"`
    Lock     LockConfig     `mapstructure:"lock"`
    App      AppConfig      `mapstructure:"app"`
    Metrics  MetricsConfig  `mapstructure:"metrics"`
    Webhook  WebhookConfig  `mapstructure:"webhook"`
}
```

**–í—Å–µ–≥–æ —Å–µ–∫—Ü–∏–π**: 10
**–í–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä**: ~15
**–ü–æ–ª—è —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏**: ~8 (passwords, api_keys, secrets)

#### 3.2 –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

1. **Defaults** (setDefaults() –≤ config.go)
2. **Config File** (YAML, —á–µ—Ä–µ–∑ viper)
3. **Environment Variables** (—á–µ—Ä–µ–∑ viper.AutomaticEnv())
4. **Command Line Flags** (—á–µ—Ä–µ–∑ -config flag)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: Flags > Env > File > Defaults

#### 3.3 –¢–æ—á–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- **main.go**: Config –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **Router**: Endpoint —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ `/api/v2/config`
- **Config Package**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `internal/config` –ø–∞–∫–µ—Ç
- **Metrics**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `pkg/metrics` registry

### 4. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

#### 4.1 –ü—Ä—è–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ **TN-019**: Config Loader (viper) - COMPLETED
- ‚úÖ **TN-021**: Prometheus Metrics - COMPLETED
- ‚úÖ **TN-181**: Metrics Registry - COMPLETED
- ‚úÖ **TN-059**: Publishing API endpoints (–ø–∞—Ç—Ç–µ—Ä–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏) - COMPLETED

#### 4.2 –û–±—Ä–∞—Ç–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–±–ª–æ–∫–∏—Ä—É–µ—Ç)
- üéØ **TN-150**: POST /api/v2/config (update config) - –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- üéØ **TN-151**: Config Validator - –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- üéØ **TN-152**: Hot Reload - –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 5. –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏–∏

#### Risk-1: –£—Ç–µ—á–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ API
- **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: Medium
- **–í–ª–∏—è–Ω–∏–µ**: Critical
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
  - ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  - ‚úÖ Admin-only –¥–æ—Å—Ç—É–ø –∫ unsanitized config
  - ‚úÖ –ê—É–¥–∏—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
  - ‚úÖ Rate limiting –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è brute force

#### Risk-2: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö
- **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: Low
- **–í–ª–∏—è–Ω–∏–µ**: Medium
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
  - ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (TTL 1s)
  - ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ sync.Pool –¥–ª—è buffers)
  - ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–µ–∫—Ü–∏–π –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è payload

#### Risk-3: –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç–æ–≤ JSON/YAML
- **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: Low
- **–í–ª–∏—è–Ω–∏–µ**: Low
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
  - ‚úÖ –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã (Config struct)
  - ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–æ–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
  - ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–∞–º–∏

#### Risk-4: –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ Config
- **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: Medium
- **–í–ª–∏—è–Ω–∏–µ**: Medium
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
  - ‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API (v2)
  - ‚úÖ Backward compatibility —á–µ—Ä–µ–∑ deprecated fields
  - ‚úÖ –¢–µ—Å—Ç—ã –Ω–∞ —Ä–µ–≥—Ä–µ—Å—Å–∏—é —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

---

## üìä Success Metrics

### –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

1. **Test Coverage**: ‚â• 85% (target 80%+, +5% bonus)
2. **Performance**: p95 < 5ms (target < 10ms, 2x better)
3. **Documentation**: ‚â• 1,000 LOC (comprehensive)
4. **Code Quality**: Zero linter warnings, zero race conditions
5. **Security**: 100% —Å–µ–∫—Ä–µ—Ç–æ–≤ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

1. **Production Code**: ~500-700 LOC (handler + service + models)
2. **Test Code**: ~800-1,000 LOC (unit + integration + benchmarks)
3. **Documentation**: ~1,500-2,000 LOC (requirements + design + tasks + README + API guide)
4. **Tests**: ‚â• 25 tests (unit + integration)
5. **Benchmarks**: ‚â• 5 benchmarks (—Ä–∞–∑–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏)

### Quality Gates

- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (100% pass rate)
- ‚úÖ Coverage ‚â• 85%
- ‚úÖ Performance targets –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã
- ‚úÖ Zero security vulnerabilities (gosec clean)
- ‚úÖ Zero linter warnings
- ‚úÖ Zero race conditions
- ‚úÖ Documentation complete
- ‚úÖ OpenAPI spec complete

---

## üéØ Acceptance Criteria

### Must Have (P0)
- [x] GET /api/v2/config –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- [x] GET /api/v2/config?format=yaml –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç YAML –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- [x] –°–µ–∫—Ä–µ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è
- [x] Prometheus metrics –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã
- [x] Structured logging —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] Error handling graceful
- [x] Unit tests ‚â• 20, coverage ‚â• 85%
- [x] OpenAPI spec —Å–æ–∑–¥–∞–Ω–∞

### Should Have (P1)
- [x] –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (version, source, loaded_at)
- [x] –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–µ–∫—Ü–∏–π —á–µ—Ä–µ–∑ ?sections=
- [x] Integration tests ‚â• 5
- [x] Benchmarks ‚â• 5
- [x] API Guide –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### Nice to Have (P2)
- [ ] Diff –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (?diff=)
- [ ] ETag caching –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [ ] Compression –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤
- [ ] GraphQL endpoint (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üìö References

1. **Alertmanager API v2**: https://prometheus.io/docs/alerting/latest/clients/
2. **Viper Configuration**: https://github.com/spf13/viper
3. **OpenAPI 3.0 Spec**: https://swagger.io/specification/
4. **12-Factor App Config**: https://12factor.net/config
5. **Go JSON/YAML**: https://pkg.go.dev/encoding/json, https://pkg.go.dev/gopkg.in/yaml.v3

---

## üìù Notes

- Endpoint –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–º –∏ –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Å–∏—Å—Ç–µ–º—É
- –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ–π, –Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º —Å Alertmanager –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–º–æ–∂–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏

---

**Document Version**: 1.0
**Last Updated**: 2025-11-21
**Author**: AI Assistant
**Review Status**: Pending
