{{- if and .Values.llm.enabled .Values.llm.secret.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Values.llm.secret.name | default (printf "%s-llm-secret" (include "alert-history.fullname" .)) }}
  namespace: {{ .Values.namespace | default .Release.Namespace }}
  labels:
    {{- include "alert-history.labels" . | nindent 4 }}
  annotations:
    {{- if .Values.llm.externalSecrets.enabled }}
    external-secrets.kubernetes-client.io/secret-store: {{ .Values.llm.externalSecrets.secretStore }}
    {{- end }}
type: Opaque
data:
  {{ .Values.llm.secret.key }}: {{ .Values.llm.apiKey | b64enc | quote }}
{{- end }}
